<Window x:Class="WpfParadojaGemelos.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfParadojaGemelos"
        mc:Ignorable="d"
        Title="Paradoja de los Gemelos" 
        Height="500" Width="900"  
        Icon="/recursos/acortes.png" 
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        MinHeight="500" MinWidth="900 "
        Background="{StaticResource BackgroundBrush}"
        Loaded="Window_Loaded"
        SizeChanged="Window_SizeChanged">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>

    <Grid Margin="{StaticResource Spacing}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Panel izquierdo: datos -->
        <Grid Name="GrdDatagrid" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel Orientation="Horizontal" 
                        VerticalAlignment="Center" 
                        Margin="0,0,0,8">
                <Button x:Name="btnLimpiarGrid"
                        Style="{DynamicResource PlantilllaBotonAzul}"
                        Content="Limpiar"
                        Width="84" Height="28"
                        Command="{Binding LimpiarGridCommand}"
                        TabIndex="3"
                        ToolTip="Limpia la tabla de valores"
                        AutomationProperties.Name="Botón Limpiar"/>
                <Button x:Name="btnEliminarElemento"
                        Style="{DynamicResource PlantilllaBotonAzul}"
                        Content="Eliminar"
                        Width="84" Height="28"
                        Margin="{StaticResource Spacing}"
                        Command="{Binding EliminarElementoCommand}"
                        CommandParameter="{Binding SelectedItem, ElementName=DGDatos}"
                        TabIndex="3"
                        ToolTip="Elimina el elemento seleccionado"
                        AutomationProperties.Name="Botón Eliminar"/>
            </StackPanel>

            <DataGrid x:Name="DGDatos"
                      Grid.Row="1"
                      AutoGenerateColumns="False"
                      Margin="0"
                      IsReadOnly="True"
                      ItemsSource="{Binding Valores}"
                      Style="{DynamicResource BaseDataGrid}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="T. Viajero" 
                                        Binding="{Binding Tiempo_Viajero}" />
                    <DataGridTextColumn Header="% C" 
                                        Binding="{Binding Porcentaje_C}" />
                    <DataGridTextColumn Header="T. Observador" 
                                        Binding="{Binding Tiempo_Observador, StringFormat={}{0:F8}}" />
                    <DataGridTextColumn Header="Masa relativa" 
                                        Binding="{Binding Masa_Relativa, StringFormat={}{0:F6}}" />
                    <DataGridTemplateColumn Header="%" Width="100">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <ProgressBar Minimum="0" 
                                                 Maximum="100" Value="{Binding Porcentaje_C ,Mode=OneWay}" 
                                                 Background="Transparent" 
                                                 Height="12"/>
                                    <TextBlock Text="{Binding Porcentaje_C}" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center" 
                                               Foreground="{StaticResource TextPrimaryBrush}" 
                                               FontSize="{StaticResource Caption}"/>
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        <!-- Imagen cohete intermedia -->
        <Image x:Name="imgCohete"
               Source="/starsship.png"
               Grid.Column="1"
               HorizontalAlignment="Center"
               VerticalAlignment="Bottom"
               Height="81"
               Margin="{StaticResource Spacing}"
               AutomationProperties.Name="Imagen Cohete">
            <Image.RenderTransform>
                <TranslateTransform x:Name="AnimacionCohete" X="0" Y="0"/>
            </Image.RenderTransform>
        </Image>

        <!-- Panel derecho: controles -->
        <Grid x:Name="grdContoles"
              Grid.Column="2" 
              Margin="16,0,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Button x:Name="btnAbout"
                    Style="{DynamicResource PlantilllaBotonAzul}"
                    Width="36" Height="36"
                    HorizontalAlignment="Right"
                    Command="{Binding OpenAboutCommand}"
                    ToolTip="Acerca de..."
                    AutomationProperties.Name="Botón Acerca de">
                <Image Source="/acercade.png" />
            </Button>

            <StackPanel Grid.Row="1" 
                        Orientation="Vertical"
                        Margin="0,8,0,0">
                <Label x:Name="lblTiempo" 
                       Content="Tiempo del viajero" 
                       HorizontalAlignment="Left" 
                       VerticalAlignment="Top" 
                       FontWeight="Bold" 
                       FontSize="16" 
                       TabIndex="0" 
                       Height="31" 
                       Width="150"/>
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="160"/>
                    </Grid.ColumnDefinitions>
                    
                <Slider x:Name="sldTiempoV" 
                        VerticalAlignment="Top" 
                        HorizontalAlignment="Stretch"
                        Minimum="1" Maximum="50" 
                        TickPlacement="BottomRight" 
                        TickFrequency="1" 
                        IsSnapToTickEnabled="True" 
                        Grid.Column="0"
                        Value="{Binding TiempoV, Mode=TwoWay}" 
                        Visibility="{Binding IsSliderVisible, Converter={StaticResource BoolToVis}}"/>
                <TextBox x:Name="txtTiempo" 
                         Grid.Column="1"  
                         HorizontalAlignment="Left"
                         TextWrapping="Wrap" 
                         Text="{Binding TiempoV, Mode=TwoWay}" 
                         VerticalAlignment="Top" 
                         Width="158" 
                         FontSize="16" 
                         KeyDown="txtTiempo_KeyDown" 
                         Height="23" 
                         TabIndex="0"/>
                </Grid>

                <Label x:Name="lblVelocidad" 
                       Content="% Velocidad de la luz" 
                       HorizontalAlignment="Left" 
                       Margin="0,0,0,8" 
                       VerticalAlignment="Top" 
                       FontWeight="Bold" 
                       FontSize="16"  
                       Height="31" 
                       Width="168"/>
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="160"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="sldPorcentajeC" 
                            VerticalAlignment="Top" 
                            HorizontalAlignment="Stretch"
                            Minimum="0" 
                            Maximum="100" 
                            TickPlacement="BottomRight" 
                            TickFrequency="5"  
                            Grid.Column="0"
                            Value="{Binding PorcentajeC, Mode=TwoWay}" 
                            Visibility="{Binding IsSliderVisible, Converter={StaticResource BoolToVis}}"/>
                    <TextBox x:Name="txtVelocidad" 
                             Grid.Column="1"  
                             HorizontalAlignment="Left" 
                             TextWrapping="Wrap" 
                             Text="{Binding PorcentajeC, Mode=TwoWay}" 
                             VerticalAlignment="Top" 
                             Width="158" 
                             FontSize="16" 
                             TabIndex="1" 
                             KeyDown="txtVelocidad_KeyDown" 
                             Height="23"/>
                </Grid>

                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="160"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" 
                                Orientation="Vertical" 
                                Margin="{StaticResource Spacing}">
                        <Label Content="Masa" 
                               FontWeight="Bold" 
                               FontSize="16" 
                               VerticalAlignment="Top" 
                               HorizontalAlignment="Left" 
                               Width="50" />
                        <TextBox x:Name="txtMasaReposo"
                                 Text="{Binding MasaReposo, Mode=TwoWay}" 
                                 VerticalAlignment="Top" 
                                 HorizontalAlignment="Left" 
                                 Width="158" 
                                 FontSize="16"
                                 TabIndex="2"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" 
                                Orientation="Vertical" 
                                Margin="{StaticResource Spacing}">
                        <Label Content="Masa Relativa" 
                               FontWeight="Bold" 
                               FontSize="16" 
                               VerticalAlignment="Top" 
                               HorizontalAlignment="Left" 
                               Width="119" />
                        <TextBox x:Name="txtMasaRelativa" 
                                 VerticalAlignment="Top" 
                                 HorizontalAlignment="Left" 
                                 Width="158" 
                                 FontSize="16" 
                                 IsReadOnly="True"
                                 Text="{Binding MasaRelativa}"/>
                    </StackPanel>
                </Grid>

                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <CheckBox x:Name="chkGraficar" 
                              Content="Autogenerar 0-99%" 
                              VerticalAlignment="Center" 
                              IsChecked="{Binding AutoGenerate, Mode=TwoWay}"
                              ToolTip="Hablilita la opción para graficar y autogenera los datos del 0-99 de la velocidad de la luz"
                              Grid.Column="0"/>
                    <Button x:Name="btnGrafico" 
                            Style="{DynamicResource PlantilllaBotonAzul}" 
                            Content="Gráfico" 
                            HorizontalAlignment="Left" 
                            VerticalAlignment="Top"
                            Height="30" 
                            Width="75" 
                            Command="{Binding OpenGraficoCommand}" 
                            FontSize="14" 
                            ToolTip="Genera el gráfico con los datos de la tabla" 
                            Grid.Column="1"
                            Visibility="{Binding ShowGraficoButton, Converter={StaticResource BoolToVis}}"/>
                    </Grid>
            </StackPanel>
            
            <StackPanel Grid.Row="2" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right" 
                        Margin="0,8,0,0">
                <Button x:Name="btnCalcular" 
                        Style="{DynamicResource PlantilllaBotonVerde}" 
                        Content="Calcular"
                        FontSize="16" 
                        Height="38" Width="110"
                        Command="{Binding CalcularCommand}" 
                        IsDefault="True" 
                        TabIndex="3"
                        AutomationProperties.Name="Botón Calcular"/>
            </StackPanel>

            <StackPanel Grid.Row="3" 
                        Orientation="Vertical" 
                        Margin="0,8,0,0">
                <Label x:Name="lblTiempo2" 
                       Content="{Binding TiempoLabel}" 
                       HorizontalAlignment="Left"  
                       FontWeight="Bold" 
                       FontSize="16"/>
                <Label x:Name="lblResultado" 
                       Content="{Binding ResultadoLabel}" 
                       HorizontalAlignment="Left" 
                       FontSize="48" 
                       FontWeight="Bold" 
                       VerticalContentAlignment="Top"/>
            </StackPanel>

        </Grid>
    </Grid>
    <!--<Window.Triggers>
     <EventTrigger RoutedEvent="Window.Loaded">
         <BeginStoryboard>
             <Storyboard>
                 <ParallelTimeline RepeatBehavior="Forever" AutoReverse="True">
                     <DoubleAnimation Storyboard.TargetName="AnimacionCohete" Storyboard.TargetProperty="Y" From="0" To="-370" Duration="0:0:2"/>
                 </ParallelTimeline>
             </Storyboard>
         </BeginStoryboard>
     </EventTrigger>
 </Window.Triggers>-->
</Window>
